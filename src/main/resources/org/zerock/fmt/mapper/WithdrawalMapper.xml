<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

    <mapper namespace="org.zerock.fmt.mapper.WithdrawalMapper">

	  <!-- 출금신청 -->
	  <insert id="insertWithdrawal">
	     INSERT INTO tbl_withdrawal
	     VALUES (w_num.NEXTVAL, #{user_email}, #{bank_account}, #{w_quantity}, #{w_price}, #{approval}, CURRENT_DATE)
	  </insert>
    
      <!-- 출금 신청 내역 목록 조회 -->
	  <select id="selectAllWithdrawalList" resultType="org.zerock.fmt.domain.WithdrawalVO">
		SELECT /*+ index_desc(tbl_withdrawal)*/ * 
		FROM tbl_withdrawal
		OFFSET (#{currPage} - 1) * #{amount} rows
		FETCH NEXT #{amount} ROWS ONLY
	</select>

      <!-- 승인여부 수정 -->
      <update id="updateState">
	      UPDATE tbl_withdrawal
	      SET approval = #{approval}
	      WHERE w_num = #{w_num}
      </update>
    	
    </mapper>    